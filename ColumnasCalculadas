| TableID | Column Name                         | Expression                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ------- | ----------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 10      | OEE Ajustado                        | SUMX(<br>    'BD_OEE',<br>    SWITCH(<br>        TRUE(),<br>        'BD_OEE'[Producto] = "Mini", 'BD_OEE'[OEE] \* 0.95,<br>        'BD_OEE'[Producto] = "Big", 'BD_OEE'[OEE] \* 0.05,<br>        'BD_OEE'[OEE]  // Si no es ni Mini ni Big, dejamos el valor original<br>    )<br>) / COUNTROWS('BD_OEE')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 10      | 00 OEE PB                           | SWITCH(<br>    TRUE(),<br>    'BD_OEE'[Linea] = "01. Linea Multiproducto 1", .595,<br>    'BD_OEE'[Linea] = "02. Linea Donas 1", .702,   <br>    'BD_OEE'[Linea] = "03. Linea Batidos 1", .743,<br>    'BD_OEE'[Linea] = "04. Linea Boleados CC1", .630,<br>    'BD_OEE'[Linea] = "05. Linea Baguette 1", .732,<br>    'BD_OEE'[Linea] = "06. Linea Batidos 2", .672,<br>    'BD_OEE'[Linea] = "07. Linea Unifiller 1", .728,<br>    'BD_OEE'[Linea] = "08. Linea Croissant 1" && 'BD_OEE'[Producto] = "Big", .5815478335456,<br>    'BD_OEE'[Linea] = "08. Linea Croissant 1" && 'BD_OEE'[Producto] = "Mini", .80,<br>    'BD_OEE'[Linea] = "09. Linea Croissant 2", .809,<br>    'BD_OEE'[Linea] = "10. Linea Cake 1" && 'BD_OEE'[Producto] = "Cake", .7993,<br>    'BD_OEE'[Linea] = "10. Linea Cake 1" && 'BD_OEE'[Producto] = "Roll", .7089,<br>    BLANK()  -- Esto es un valor predeterminado si no coincide con ninguno de los productos mencionados<br>)                                |
| 10      | 01 Disponibilidad PB                | SWITCH(<br>    TRUE(),<br>    BD_OEE[Linea] = "01. Linea Multiproducto 1", 0.920,<br>    BD_OEE[Linea] = "02. Linea Donas 1", 0.930,<br>    BD_OEE[Linea] = "03. Linea Batidos 1", 0.970,<br>    BD_OEE[Linea] = "04. Linea Boleados CC1", 0.960,<br>    BD_OEE[Linea] = "05. Linea Baguette 1", 0.970,<br>    BD_OEE[Linea] = "06. Linea Batidos 2", 0.980,<br>    BD_OEE[Linea] = "07. Linea Unifiller 1", 0.980,<br>    BD_OEE[Linea] = "08. Linea Croissant 1", 0.935,<br>    BD_OEE[Linea] = "09. Linea Croissant 2", 0.918,<br>    BD_OEE[Linea] = "10. Linea Cake 1", 0.954,<br>    BLANK()  -- Valor predeterminado si no coincide con ninguna línea<br>)                                                                                                                                                                                                                                                                                                                                |
| 10      | 02 Rendimiento PB                   | SWITCH(<br>    TRUE(),<br>    BD_OEE[Linea] = "01. Linea Multiproducto 1", 0.660,<br>    BD_OEE[Linea] = "02. Linea Donas 1", 0.770,<br>    BD_OEE[Linea] = "03. Linea Batidos 1", 0.790,<br>    BD_OEE[Linea] = "04. Linea Boleados CC1", 0.670,<br>    BD_OEE[Linea] = "05. Linea Baguette 1", 0.770,<br>    BD_OEE[Linea] = "06. Linea Batidos 2", 0.700,<br>    BD_OEE[Linea] = "07. Linea Unifiller 1", 0.790,<br>    BD_OEE[Linea] = "08. Linea Croissant 1", 0.865,<br>    BD_OEE[Linea] = "09. Linea Croissant 2", 0.899,<br>    BD_OEE[Linea] = "10. Linea Cake 1", 0.8453,<br>    BLANK()  -- Valor predeterminado si no coincide con ninguna línea<br>)                                                                                                                                                                                                                                                                                                                               |
| 10      | 03 Calidad PB                       | SWITCH(<br>    TRUE(),<br>    BD_OEE[Linea] = "01. Linea Multiproducto 1", 0.980,<br>    BD_OEE[Linea] = "02. Linea Donas 1", 0.980,<br>    BD_OEE[Linea] = "03. Linea Batidos 1", 0.970,<br>    BD_OEE[Linea] = "04. Linea Boleados CC1", 0.980,<br>    BD_OEE[Linea] = "05. Linea Baguette 1", 0.980,<br>    BD_OEE[Linea] = "06. Linea Batidos 2", 0.980,<br>    BD_OEE[Linea] = "07. Linea Unifiller 1", 0.940,<br>    BD_OEE[Linea] = "08. Linea Croissant 1", 0.978,<br>    BD_OEE[Linea] = "09. Linea Croissant 2", 0.980,<br>    BD_OEE[Linea] = "10. Linea Cake 1", 0.898,<br>    BLANK()  -- Valor predeterminado si no coincide con ninguna línea<br>)                                                                                                                                                                                                                                                                                                                                |
| 10      | Margen Diferencia Monetaria Columna | VAR OEE_Base = 'BD_OEE'[00 OEE PB]<br>VAR OEE_Real = 'BD_OEE'[OEE]<br><br>VAR DifKilos =<br>    IF(<br>        OEE_Real = 0 \|\| ISBLANK(OEE_Real) \|\| ISBLANK(OEE_Base),<br>        0,<br>        'BD_OEE'[Pzs Producidas] - ('BD_OEE'[Pzs Producidas] \* (OEE_Base / OEE_Real))<br>    )<br><br>VAR Planta = 'BD_OEE'[Planta]<br>VAR Producto = 'BD_OEE'[Producto]<br><br>VAR CostoPorKilo =<br>    SWITCH(<br>        TRUE(),<br>        Planta = "Congelados", 69.11,<br>        Planta = "Vuala" && Producto = "Big", 8.1,<br>        Planta = "Vuala" && (Producto = "Cake" \|\| Producto = "Roll"), 4.28,<br>        Planta = "Vuala" && Producto = "Mini", 11.02,<br>        0 -- En caso de que no cumpla ninguna condición, se pone 0<br>    )<br><br>VAR DiferenciaMonetaria = DifKilos \* CostoPorKilo<br>VAR Resultado = (DiferenciaMonetaria \* 0.1143)  / 20.5 -- Conversión a dólares<br><br>RETURN<br>    IF( ISBLANK(Resultado) \|\| NOT(ISNUMBER(Resultado)), 0, Resultado ) |
| 10      | 00 OEE Mejora Porcentual            | IF(BD_OEE[OEE]=0,0,BD_OEE[OEE]-BD_OEE[00 OEE PB])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 10      | 00 OEE PB 2                         | SWITCH(<br>    TRUE(),<br>    'BD_OEE'[Linea] = "01. Linea Multiproducto 1", .595,<br>    'BD_OEE'[Linea] = "02. Linea Donas 1", .74,   <br>    'BD_OEE'[Linea] = "03. Linea Batidos 1", .743,<br>    'BD_OEE'[Linea] = "04. Linea Boleados CC1", .630,<br>    'BD_OEE'[Linea] = "05. Linea Baguette 1", .732,<br>    'BD_OEE'[Linea] = "06. Linea Batidos 2", .672,<br>    'BD_OEE'[Linea] = "07. Linea Unifiller 1", .728,<br>    'BD_OEE'[Linea] = "08. Linea Croissant 1" , .791,<br>    'BD_OEE'[Linea] = "09. Linea Croissant 2", .809,<br>    'BD_OEE'[Linea] = "10. Linea Cake 1", .7241,<br>    BLANK()  -- Esto es un valor predeterminado si no coincide con ninguno de los productos mencionados<br>)                                                                                                                                                                                                                                                                                |
| 10      | 00 OEE Objetivo                     | SWITCH(<br>    TRUE(),<br>    'BD_OEE'[Linea] = "01. Linea Multiproducto 1", .756,<br>    'BD_OEE'[Linea] = "02. Linea Donas 1", .729,   <br>    'BD_OEE'[Linea] = "03. Linea Batidos 1", .772,<br>    'BD_OEE'[Linea] = "04. Linea Boleados CC1", .753,<br>    'BD_OEE'[Linea] = "05. Linea Baguette 1", .76,<br>    'BD_OEE'[Linea] = "06. Linea Batidos 2", .768,<br>    'BD_OEE'[Linea] = "07. Linea Unifiller 1", .76,<br>    'BD_OEE'[Linea] = "08. Linea Croissant 1" , .829,<br>    'BD_OEE'[Linea] = "09. Linea Croissant 2", .838,<br>    'BD_OEE'[Linea] = "10. Linea Cake 1", .618,<br>    BLANK()  -- Esto es un valor predeterminado si no coincide con ninguno de los productos mencionados<br>)                                                                                                                                                                                                                                                                                  |
| 13      | Año                                 | YEAR(Calendario[Date])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 13      | Semana                              | WEEKNUM(Calendario[Date], 2)  // El '2' indica que la semana empieza el lunes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 2208    | Semana Anterior                     | CALCULATE(<br>    SUM(BD_Merma[Merma]),<br>    FILTER(<br>        BD_Merma,<br>        BD_Merma[Semana] = MAX(BD_Merma[Semana]) - 1 && BD_Merma[Linea]= MAX(BD_Merma[Linea])<br>    )<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 2208    | Merma KG                            | SWITCH(<br>    TRUE(),<br>    BD_Merma[Atributo] = "Mini Vuala Linea 1", BD_Merma[Merma] \* 60 / 1000,<br>    BD_Merma[Atributo] = "Mini Vuala Linea 2", BD_Merma[Merma] \* 60 / 1000,<br>    BD_Merma[Atributo] = "Big Vuala", BD_Merma[Merma] \* 75 / 1000,<br>    BD_Merma[Atributo] = "Swich", BD_Merma[Merma] \* 32 / 1000,<br>    BD_Merma[Atributo] = "Roll", BD_Merma[Merma] \* 32 / 1000,<br>    BD_Merma[Merma]<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 103199  | Semana Paros                        | WEEKNUM(BD_AppParos[FechaHora])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 103199  | Alerta                              | BD_AppParos[Tiempo]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
